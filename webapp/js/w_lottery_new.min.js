var turnplate={restaraunts:[],colors:[],outsideRadius:192,textRadius:155,insideRadius:68,startAngle:0,bRotate:!1};function getCookieValue(d){var b=document.cookie,a=b.indexOf(""+d+"=");-1==a&&(a=b.indexOf(d+"="));-1==a?b=null:(a=b.indexOf("=",a)+1,cookieEndAt=b.indexOf(";",a),-1==cookieEndAt&&(cookieEndAt=b.length),b=unescape(b.substring(a,cookieEndAt)));return b}
$(document).ready(function(){if(null!=getCookieValue("globalID"))$(".register").show(),$(".lottery").hide();else{$(".register").hide();$(".lottery").show();turnplate.restaraunts="2G\u6d41\u91cf\u5361 10M\u6d41\u91cf\u5361 500M\u6d41\u91cf\u5361 10M\u6d41\u91cf\u5361 1G\u6d41\u91cf\u5361 10M\u6d41\u91cf\u5361".split(" ");turnplate.colors="#fac31e #ff8740 #ff6666 #6399d9 #d265dc #3bd5c8".split(" ");var d=function(b,a){var c=360/turnplate.restaraunts.length*b-360/(2*turnplate.restaraunts.length),c=270>
c?270-c:360-c+270;$("#wheelcanvas").stopRotate();$("#wheelcanvas").rotate({angle:0,animateTo:c+1800,duration:8E3,callback:function(){$(".register").show();$(".lottery").hide();turnplate.bRotate=!turnplate.bRotate}})};$(".close").click(function(){$(".popup").hide();$(".turnplate").removeClass("tf")});$(".pointer").click(function(){$(".turnplate ").addClass("tf");turnplate.bRotate||(turnplate.bRotate=!turnplate.bRotate,$("#wheelcanvas").rotate({angle:0,animateTo:6800,duration:18E3,callback:function(){turnplate.bRotate=
    !turnplate.bRotate}}),$.ajax({url:"/api/web/lottery/shared",type:"post",dataType:"json",success:function(b){if(0==b.status)if(1==b.data.beHint){var a=b.data.lotteryHint,c=sharedToken;localStorage.setItem("__rwlotteryglobalid__",b.data.globalID);localStorage.setItem("__rwlotterysharedtoken__",c);$("#wheelcanvas").stopRotate();d(a+1,turnplate.restaraunts[a])}else $("#wheelcanvas").stopRotate(),$(".turnplate ").removeClass("tf"),alert("\u672a\u4e2d\u5956");else $("#wheelcanvas").stopRotate(),$(".turnplate ").removeClass("tf"),
    alert(b.msg)},error:function(b,a,c){$("#wheelcanvas").stopRotate();alert(c)}}),$(this).unbind("click"))})}});function rnd(d,b){return Math.floor(Math.random()*(b-d+1)+d)}window.onload=function(){drawRouletteWheel()};
function drawRouletteWheel(){var d=document.getElementById("wheelcanvas");if(d.getContext){var b=Math.PI/(turnplate.restaraunts.length/2),a=d.getContext("2d");a.clearRect(0,0,422,422);a.strokeStyle="#FFBE04";a.font="16px Microsoft YaHei";for(d=0;d<turnplate.restaraunts.length;d++){var c=turnplate.startAngle+d*b;a.fillStyle=turnplate.colors[d];a.beginPath();a.arc(211,211,turnplate.outsideRadius,c,c+b,!1);a.arc(211,211,turnplate.insideRadius,c+b,c,!0);a.stroke();a.fill();a.save();a.fillStyle="#ffffff";
    var f=turnplate.restaraunts[d];a.translate(211+Math.cos(c+b/2)*turnplate.textRadius,211+Math.sin(c+b/2)*turnplate.textRadius);a.rotate(c+b/2+Math.PI/2);if(0<f.indexOf(""))for(c=0;c<e.length;c++)0==c?a.fillText(e[c]+"",-a.measureText(e[c]+"").width/2,17*c):a.fillText(e[c],-a.measureText(e[c]).width/2,17*c);else if(16<f.length)for(var e=f=f.substring(0,16)+f.substring(16),c=0;c<e.length;c++)a.fillText(e[c],-a.measureText(e[c]).width/2,17*c);else a.fillText(f,-a.measureText(f).width/2,0);var g=document.getElementById("icon"+
        d);g&&(g.onload=function(){a.drawImage(g,-32,15)},a.drawImage(g,-32,15));a.restore()}}}
$(function(){var d=!1,b=!1;$(".close").click(function(){$(".popup").hide()});$('input[name="phonenum"]').blur(function(){d=!1;$(this).val().match(/^(13|15|18|14|17)\d{9}$/)&&""!=$(this).val()&&(d=!0)});$("input").bind("focus",function(){$("body").height($(window).height()+"px")}).bind("blur",function(){$("body").height("auto")});$(".test_button").click(function(){if($('input[name="phonenum"]').val().match(/^(13|15|18|14|17)\d{9}$/)&&""!=$(this).val()){var a=function(b){0==c?(b.removeAttribute("disabled"),
    b.value="\u91cd\u65b0\u53d1\u9001",c=60,$(b).css({background:"#5dd3ff"})):(b.setAttribute("disabled",!0),b.value=c+"s",c--,$(b).css({background:"#b6b6b6","font-size":"1.1rem"}),setTimeout(function(){a(b)},1E3))},c=60;a(this);var b=$('input[name="phonenum"]').val();$.ajax({url:"/api/web/lottery/getverifcation",data:{phone:b},type:"post",dataType:"json",async:!1,success:function(a){"0"==a.status&&$(".test_button").addClass("code")},error:function(){}})}});$('input[name="Vcode"]').blur(function(){b=
    !1;""!=$(this).val()&&(b=!0)});$("#submit").click(function(){if(!d)return $(".un1").focus(),!1;if(!b)return $(".un2").focus(),!1;var a=$("input[name='phonenum']").val(),c=$('input[name="Vcode"]').val(),f=localStorage.getItem("__rwlotteryglobalid__")||"",e=localStorage.getItem("__rwlotterysharedtoken__")||"";$.ajax({url:"/api/web/lottery/checkphone",type:"post",dataType:"json",data:{phone:a,verification:c,globalId:f,sharedToken:e},success:function(a){if("0"==a.status)$(".popup").show(),$(".close").click(function(){$(".popup").hide()});
else if("7"==a.status)$(".weChart_red_form").hide(),$(".join").show(),$(".weChart_redbg").css({background:"url(../images/red_ye.png) 0 0 no-repeat","-webkit-background-size":"100% 24.47rem","background-size":"100% 23.47rem"});else return alert(a.msg),!1},error:function(a,b,c){console.log(b)}})})});