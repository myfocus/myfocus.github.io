function getCookieValue(t){var e=document.cookie,a=e.indexOf(""+t+"=");return-1==a&&(a=e.indexOf(t+"=")),-1==a?e=null:(a=e.indexOf("=",a)+1,cookieEndAt=e.indexOf(";",a),-1==cookieEndAt&&(cookieEndAt=e.length),e=unescape(e.substring(a,cookieEndAt))),e}function rnd(t,e){var a=Math.floor(Math.random()*(e-t+1)+t);return a}function drawRouletteWheel(){var t=document.getElementById("wheelcanvas");if(t.getContext){var e=Math.PI/(turnplate.restaraunts.length/2),a=t.getContext("2d");a.clearRect(0,0,422,422),a.strokeStyle="#FFBE04",a.font="16px Microsoft YaHei";for(var n=0;n<turnplate.restaraunts.length;n++){var o=turnplate.startAngle+n*e;a.fillStyle=turnplate.colors[n],a.beginPath(),a.arc(211,211,turnplate.outsideRadius,o,o+e,!1),a.arc(211,211,turnplate.insideRadius,o+e,o,!0),a.stroke(),a.fill(),a.save(),a.fillStyle="#ffffff";var r=turnplate.restaraunts[n],l=17;if(a.translate(211+Math.cos(o+e/2)*turnplate.textRadius,211+Math.sin(o+e/2)*turnplate.textRadius),a.rotate(o+e/2+Math.PI/2),r.indexOf("")>0)for(var s=0;s<i.length;s++)0==s?a.fillText(i[s]+"",-a.measureText(i[s]+"").width/2,s*l):a.fillText(i[s],-a.measureText(i[s]).width/2,s*l);else if(r.length>16){r=r.substring(0,16)+r.substring(16);for(var i=r,s=0;s<i.length;s++)a.fillText(i[s],-a.measureText(i[s]).width/2,s*l)}else a.fillText(r,-a.measureText(r).width/2,0);var u=document.getElementById("icon"+n);u&&(u.onload=function(){a.drawImage(u,-32,15)},a.drawImage(u,-32,15)),a.restore()}}}var turnplate={restaraunts:[],colors:[],outsideRadius:192,textRadius:155,insideRadius:68,startAngle:0,bRotate:!1};$(document).ready(function(){var t=getCookieValue("globalID");if(null!=t)return window.location.href="../w_luck_register.jsp?sharedToken="+sharedToken,void 0;turnplate.restaraunts=["2G\u6d41\u91cf\u5361","10M\u6d41\u91cf\u5361","500M\u6d41\u91cf\u5361","10M\u6d41\u91cf\u5361","1G\u6d41\u91cf\u5361","10M\u6d41\u91cf\u5361"],turnplate.colors=["#fac31e","#ff8740","#ff6666","#6399d9","#d265dc","#3bd5c8"];var e=function(t){var e=t*(360/turnplate.restaraunts.length)-360/(2*turnplate.restaraunts.length);e=270>e?270-e:360-e+270,$("#wheelcanvas").stopRotate(),$("#wheelcanvas").rotate({angle:0,animateTo:e+1800,duration:8e3,callback:function(){window.location.href="../w_luck_register.jsp?sharedToken="+sharedToken,turnplate.bRotate=!turnplate.bRotate}})};$(".close").click(function(){$(".popup").hide(),$(".turnplate").removeClass("tf")}),$(".pointer").click(function(){$(".turnplate ").addClass("tf"),turnplate.bRotate||(turnplate.bRotate=!turnplate.bRotate,$("#wheelcanvas").rotate({angle:0,animateTo:6800,duration:18e3,callback:function(){turnplate.bRotate=!turnplate.bRotate}}),$.ajax({url:"/api/web/lottery/shared",type:"post",dataType:"json",success:function(t){if(0==t.status)if(1==t.data.beHint){var a=t.data.lotteryHint,n=t.data.globalID,o=sharedToken;localStorage.setItem("__rwlotteryglobalid__",n),localStorage.setItem("__rwlotterysharedtoken__",o),$("#wheelcanvas").stopRotate(),e(a+1,turnplate.restaraunts[a])}else $("#wheelcanvas").stopRotate(),$(".turnplate ").removeClass("tf"),alert("\u672a\u4e2d\u5956");else{$("#wheelcanvas").stopRotate(),$(".turnplate ").removeClass("tf");var r=t.msg;alert(r)}},error:function(t,e,a){$("#wheelcanvas").stopRotate(),alert(a)}}),$(this).unbind("click"))})}),window.onload=function(){drawRouletteWheel()};