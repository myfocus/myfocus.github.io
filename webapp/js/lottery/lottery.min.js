function getCookieValue(t){var e=document.cookie,a=e.indexOf(""+t+"=");return-1==a&&(a=e.indexOf(t+"=")),-1==a?e=null:(a=e.indexOf("=",a)+1,cookieEndAt=e.indexOf(";",a),-1==cookieEndAt&&(cookieEndAt=e.length),e=unescape(e.substring(a,cookieEndAt))),e}function getUrlParam(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(e);return null!=a?unescape(a[2]):null}function changeImg(){var t=$("#imgObj"),e=t.attr("src");t.attr("src",chgUrl(e))}function chgUrl(t){var e=(new Date).valueOf();return t=t.substring(0,22),t=t.indexOf("&")>=0?t+"\xd7tamp="+e:t+"?timestamp="+e}$(document).ready(function(){var t=getCookieValue("globalID");return null!=t?($(".register").show(),$(".lottery").hide(),void 0):($(".register").hide(),$(".lottery").show(),void 0)}),$(function(){var t=!1,e=function(e,a){t=!t,$("#turntableimg").stopRotate(),$("#turntableimg").rotate({angle:0,animateTo:a+1800,duration:8e3,callback:function(){$(".register").show(),$(".lottery").hide(),changeImg(),t=!t}})};$(".rotate").click(function(){$(".deng ").addClass("tf"),t||(t=!t,$("#turntableimg").rotate({angle:0,animateTo:6800,duration:18e3,callback:function(){t=!t}}),$.ajax({url:"/api/web/lottery/shared",type:"post",dataType:"json",success:function(t){var a=t.msg;if(0==t.status)if(1==t.data.beHint){var n=t.data.lotteryHint;switch($("#turntableimg").stopRotate(),n){case 0:e(0,240,"2G\u6d41\u91cf\u5361");break;case 1:e(1,180,"10M\u6d41\u91cf\u5361");break;case 2:e(2,120,"500M\u6d41\u91cf\u5361");break;case 3:e(3,60,"10M\u6d41\u91cf\u5361");break;case 4:e(4,360,"1G\u6d41\u91cf\u5361");break;case 5:e(5,300,"10M\u6d41\u91cf\u5361")}}else $("#turntableimg").stopRotate(),$(".turnplate ").removeClass("tf"),alert("\u672a\u4e2d\u5956");else $("#turntableimg").stopRotate(),$(".turnplate ").removeClass("tf"),alert(a)},error:function(t,e,a){$("#turntableimg").stopRotate(),alert(a)}}),$(this).unbind("click"))})}),$(function(){function t(){var t=$('input[name="phonenum"]').val();return t.match(/^(13|15|18|14|17)\d{9}$/)&&""!=t?!0:(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"),!1)}function e(){var t=$("#vcode").val();return t.match(/^\d{1,20}$/)&&""!=t?!0:(alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u9a8c\u8bc1\u7801"),!1)}$(".test_button").click(function(){var t=$('input[name="phonenum"]').val();$.ajax({url:"/api/web/lottery/getverifcation",data:{phone:t},type:"post",dataType:"json",async:!1,success:function(t){"0"==t.status&&$(".test_button").addClass("code")},error:function(){"0"!==result.status}})}),$('input[type="tel"]').bind("focus",function(){$("body").height($(window).height()+"px")}).bind("blur",function(){$("body").height("auto")}),$("#submit").click(function(){if(t()){var a=/MicroMessenger/.test(navigator.userAgent);if(a||e()){var n=$("input[name='phonenum']").val(),o=getCookieValue("globalID"),r=getUrlParam("sharedToken"),i=$("#vcode").val();$.ajax({url:"/api/web/lottery/checkphone",type:"post",dataType:"json",data:{phone:n,globalId:o,sharedToken:r,vcode:i},success:function(t){if("0"==t.status)$(".popup").show();else{if("7"!=t.status)return alert(t.msg),changeImg(),!1;$(".weChart_red_form").hide(),$(".join").show(),$(".weChart_redbg").css({background:"url(../../images/red_ye.png) 0 0 no-repeat","-webkit-background-size":"100% 24.47rem","background-size":"100% 23.47rem"})}},error:function(t,e){console.log(e)}})}}})});