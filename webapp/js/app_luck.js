function rnd(t,e){var a=Math.floor(Math.random()*(e-t+1)+t);return a}function drawRouletteWheel(){var t=document.getElementById("wheelcanvas");if(t.getContext){var e=Math.PI/(turnplate.restaraunts.length/2),a=t.getContext("2d");a.translate(.5,.5),a.clearRect(0,0,422,422),a.strokeStyle="#FFBE04",a.font="16px Microsoft YaHei";for(var n=0;n<turnplate.restaraunts.length;n++){var r=turnplate.startAngle+n*e;a.fillStyle=turnplate.colors[n],a.beginPath(),a.arc(211,211,turnplate.outsideRadius,r,r+e,!1),a.arc(211,211,turnplate.insideRadius,r+e,r,!0),a.stroke(),a.fill(),a.save(),a.fillStyle="#ffffff";var l=turnplate.restaraunts[n],o=17;if(a.translate(211+Math.cos(r+e/2)*turnplate.textRadius,211+Math.sin(r+e/2)*turnplate.textRadius),a.rotate(r+e/2+Math.PI/2),l.indexOf("")>0)for(var s=0;s<u.length;s++)0==s?a.fillText(u[s]+"",-a.measureText(u[s]+"").width/2,s*o):a.fillText(u[s],-a.measureText(u[s]).width/2,s*o);else if(l.length>16){l=l.substring(0,16)+l.substring(16);for(var u=l,s=0;s<u.length;s++)a.fillText(u[s],-a.measureText(u[s]).width/2,s*o)}else a.fillText(l,-a.measureText(l).width/2,0);if(l.indexOf("\u53e3\u7cae")>0){var i=document.getElementById("icon0");i.onload=function(){a.drawImage(i,-25,10)},a.drawImage(i,-25,10)}else if(l.indexOf("500")>=0){var i=document.getElementById("icon1");i.onload=function(){a.drawImage(i,-32,15)},a.drawImage(i,-32,15)}else if(l.indexOf("1G")>=0){var i=document.getElementById("icon4");i.onload=function(){a.drawImage(i,-32,15)},a.drawImage(i,-32,15)}a.restore()}}}var turnplate={restaraunts:[],colors:[],outsideRadius:192,textRadius:155,insideRadius:68,startAngle:0,bRotate:!1};$(document).ready(function(){turnplate.restaraunts=["50\u65a4\u53e3\u7cae","500M\u6d41\u91cf\u5361","100\u65a4\u53e3\u7cae","20\u65a4\u53e3\u7cae","1G\u6d41\u91cf\u5361","5\u65a4\u53e3\u7cae"],turnplate.colors=["#ff6666","#fad423","#d265dc","#6399d9","#3bd5c8","#ff8740"];var t=function(t,e){var a=t*(360/turnplate.restaraunts.length)-360/(2*turnplate.restaraunts.length);a=270>a?270-a:360-a+270,$("#wheelcanvas").stopRotate(),$("#wheelcanvas").rotate({angle:0,animateTo:a+3600,duration:5e3,callback:function(){$(".turnplate ").removeClass("tf"),$(".popup").show(),$(".prize").text(e),turnplate.bRotate=!turnplate.bRotate}})};$(".close").click(function(){$(".popup").hide(),$(".turnplate ").removeClass("tf")}),$(".pointer").on("click",function(){if($(".turnplate ").addClass("tf"),0==useLottery){if(turnplate.bRotate)return;turnplate.bRotate=!turnplate.bRotate,$("#wheelcanvas").rotate({angle:0,animateTo:6800,duration:18e3,callback:function(){turnplate.bRotate=!turnplate.bRotate}}),$.ajax({url:"/api/web/lottery/normal",type:"post",dataType:"json",success:function(e){if(0==e.status)if(1==e.data.beHint){var a=e.data.lotteryHintApp;$("#wheelcanvas").stopRotate(),t(a+1,turnplate.restaraunts[a])}else $("#wheelcanvas").stopRotate(),alert("\u672a\u4e2d\u5956");else $("#wheelcanvas").stopRotate(),e.msg},error:function(){$("#wheelcanvas").stopRotate()}})}else $(".popup").show(),$(".luck_tip").text("\u4eca\u5929\u5df2\u7ecf\u62bd\u8fc7\u5566"),$(".turnplate ").removeClass("tf");$(this).unbind("click"),$(this).on("click",function(){$(".turnplate ").removeClass("tf"),$(".popup").show(),$(".luck_tip").text("\u4eca\u5929\u5df2\u7ecf\u62bd\u8fc7\u5566")})})}),window.onload=function(){drawRouletteWheel(),$(".turnplate").show()};